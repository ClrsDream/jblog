<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{/layout/app :: layout(~{::title}, ~{::#content})}">
<head>
    <title>[[${post.getTitle()}]]</title>
</head>
<body>
<div id="content">
    <div class="max-w-2xl mx-auto">
        <h1 class="block w-full py-6 text-3xl text-gray-400">
            [[${post.getTitle()}]]
        </h1>
        <div class="flex">
            <a th:href="@{${router.MEMBER_DETAIL}(id=${post.getUser().getId()})}">
                <img th:src="${post.getUser().getAvatar()}" class="w-12 h-12 mt-1 mb-1 border-2 border-gray-700 rounded-full">
            </a>
            <div class="ml-2 text-gray-500">
                <span class="text-gray-400 text-lg">[[${post.getUser().getNickname()}]]</span><br>
                <span class="text-sm">[(${md.toHTML(post.getUser().getIntro())})]</span>
            </div>
        </div>
        <div class="pt-5" th:if="${tags.size() > 0}">
            <a th:each="tag : ${tags}" href="#" class="inline-block px-1 bg-gray-600 mr-2 mb-2 rounded-lg text-gray-300">[[${tag.getName()}]]</a>
        </div>
        <div id="content" class="leading-loose text-gray-500 pt-5">[(${post.getContent()})]</div>
        
        <div class="w-full py-8 text-center">
            <span id="favorite-button" class="inline-block px-5 py-3 text-2xl border border-gray-500 text-gray-500 rounded-lg">
                <i class="fa" th:classappend="${fav} ? 'fa-heart' : 'fa-heart-o'"></i><br>
                喜欢
            </span>
        </div>
        <div class="w-full mt-1 text-center">
            <img th:each="user : ${favUsers}" th:src="${user.getAvatar()}" th:alt="${user.getNickname()}" class="inline-block w-8 h-8 mr-2 mb-2 border-2 border-gray-500 rounded-full">
        </div>

        <div class="w-full mt-10 border-2 border-gray-900 mb-10 rounded-lg">
            <div class="w-full text-gray-500 px-3 py-2 bg-gray-900 text-gray-500">下面的的文章您可能也感兴趣</div>
            <div class="pl-8 py-2">
                <ul class="list-disc">
                    <li class="leading-loose">
                        <a class="hover:text-indigo-500 text-gray-500" href="#">我常常因为不够变态而与你们格格不入</a>
                    </li>
                </ul>
            </div>
        </div>

        <script>
            $(function () {
                var isLogin = [[${userService.getUser() != null ? 1: 0}]];
                $('#favorite-button').click(function () {
                    if (!isLogin) {
                        window.location.href = "[[${router.LOGIN}]]";
                        return;
                    }
                    $.post("[[${router.POST_FAVORITE}]]", {
                        id: "[[${post.getId()}]]"
                    }, function (res) {
                        if (res === 0) {
                            // 操作成功
                            if ($('#favorite-button i').hasClass("fa-heart")) {
                                $('#favorite-button i').removeClass('fa-heart').addClass('fa-heart-o');
                            } else {
                                $('#favorite-button i').removeClass('fa-heart-o').addClass('fa-heart');
                            }
                        }
                    }, 'json');
                });
            });
        </script>
    </div>
</div>
</body>
</html>